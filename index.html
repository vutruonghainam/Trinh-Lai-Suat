<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng c·ª• Tr√¨nh L√£i Su·∫•t Ti·∫øt Ki·ªám VPBank</title>
    
    <!-- 1. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #f0f9ff; }
        input:focus, select:focus { outline: none; border-color: #4f46e5; ring: 2px; }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        /* Table styles */
        th, td { white-space: nowrap; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const InterestApprovalTool = () => {
            const [activeTab, setActiveTab] = useState('proposal'); 
            
            // --- STATE ---
            const [authAmount, setAuthAmount] = useState(1000000000); 
            const [authMonth, setAuthMonth] = useState(6); 
            const [depositType, setDepositType] = useState('online'); 
            const [paymentMethod, setPaymentMethod] = useState('maturity'); 

            // Logic reset ph∆∞∆°ng th·ª©c tr·∫£ l√£i
            useEffect(() => {
                const m = Number(authMonth) || 0;
                if (m < 3 && (paymentMethod === 'monthly' || paymentMethod === 'quarterly')) setPaymentMethod('maturity');
                if (m < 6 && (paymentMethod === '6months' || paymentMethod === 'quarterly')) setPaymentMethod('maturity');
                if (m < 12 && paymentMethod === 'yearly') setPaymentMethod('maturity');
            }, [authMonth, paymentMethod]);

            // Helper format
            const formatNumberWithDots = (value) => {
                if (value === '' || value === undefined || value === null) return '';
                return new Intl.NumberFormat('vi-VN').format(value);
            };

            const formatCurrency = (value) => new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(value);
            
            const getNimColor = (nimVal) => {
                if (nimVal >= 1.0) return "text-emerald-600 bg-emerald-50 border-emerald-200";
                if (nimVal > 0) return "text-yellow-600 bg-yellow-50 border-yellow-200";
                return "text-red-600 bg-red-50 border-red-200";
            };

            // ==========================================
            // 1. DATA: NI√äM Y·∫æT (HI·ªÜU L·ª∞C 09/12/2025)
            // ==========================================
            const listingDataMaturity = {
                counter: [
                    { range: '< 1 t·ª∑', min: 0, max: 1000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 5.80, m7: 5.80, m8: 5.80, m9: 5.80, m10: 5.80, m11: 5.80, m12: 5.80, m13: 5.80, m15: 5.80, m18: 5.80, m24: 5.80, m36: 5.80 } },
                    { range: '1 t·ª∑ - < 3 t·ª∑', min: 1000000000, max: 3000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 5.80, m7: 5.80, m8: 5.80, m9: 5.80, m10: 5.80, m11: 5.80, m12: 5.80, m13: 5.80, m15: 5.80, m18: 5.80, m24: 5.80, m36: 5.80 } },
                    { range: '3 t·ª∑ - < 10 t·ª∑', min: 3000000000, max: 10000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 5.80, m7: 5.80, m8: 5.80, m9: 5.80, m10: 5.80, m11: 5.80, m12: 5.80, m13: 5.80, m15: 5.80, m18: 5.80, m24: 5.80, m36: 5.80 } },
                    { range: '10 t·ª∑ - < 50 t·ª∑', min: 10000000000, max: 50000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 5.90, m7: 5.90, m8: 5.90, m9: 5.90, m10: 5.90, m11: 5.90, m12: 5.90, m13: 5.90, m15: 5.90, m18: 5.90, m24: 5.90, m36: 5.90 } },
                    { range: '‚â• 50 t·ª∑', min: 50000000000, max: Infinity, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 6.00, m7: 6.00, m8: 6.00, m9: 6.00, m10: 6.00, m11: 6.00, m12: 6.00, m13: 6.00, m15: 6.00, m18: 6.00, m24: 6.00, m36: 6.00 } },
                ],
                online: [
                    { range: '< 1 t·ª∑', min: 0, max: 1000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 6.00, m7: 6.00, m8: 6.00, m9: 6.00, m10: 6.00, m11: 6.00, m12: 6.00, m13: 6.00, m15: 6.00, m18: 6.00, m24: 6.00, m36: 6.00 } },
                    { range: '1 t·ª∑ - < 3 t·ª∑', min: 1000000000, max: 3000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 6.00, m7: 6.00, m8: 6.00, m9: 6.00, m10: 6.00, m11: 6.00, m12: 6.00, m13: 6.00, m15: 6.00, m18: 6.00, m24: 6.00, m36: 6.00 } },
                    { range: '3 t·ª∑ - < 10 t·ª∑', min: 3000000000, max: 10000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 6.00, m7: 6.00, m8: 6.00, m9: 6.00, m10: 6.00, m11: 6.00, m12: 6.00, m13: 6.00, m15: 6.00, m18: 6.00, m24: 6.00, m36: 6.00 } },
                    { range: '10 t·ª∑ - < 50 t·ª∑', min: 10000000000, max: 50000000000, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 6.10, m7: 6.10, m8: 6.10, m9: 6.10, m10: 6.10, m11: 6.10, m12: 6.10, m13: 6.10, m15: 6.10, m18: 6.10, m24: 6.10, m36: 6.10 } },
                    { range: '‚â• 50 t·ª∑', min: 50000000000, max: Infinity, rates: { w1_3: 0.40, m1: 4.75, m2: 4.75, m3: 4.75, m4: 4.75, m5: 4.75, m6: 6.20, m7: 6.20, m8: 6.20, m9: 6.20, m10: 6.20, m11: 6.20, m12: 6.20, m13: 6.20, m15: 6.20, m18: 6.20, m24: 6.20, m36: 6.20 } },
                ]
            };

            const listingDataPrepaid = [
                {
                    range: '< 5 t·ª∑', min: 0, max: 5000000000,
                    rates: {
                        1: 4.73, 2: 4.71, 3: 4.69, 4: 4.68, 5: 4.66,
                        6: 5.64, 7: 5.61, 8: 5.58, 9: 5.56, 10: 5.53, 11: 5.51,
                        12: 5.48, 13: 5.46, 15: 5.41, 18: 5.34, 24: 5.20, 36: 4.94
                    }
                },
                {
                    range: '‚â• 5 t·ª∑', min: 5000000000, max: Infinity,
                    rates: {
                        1: 4.73, 2: 4.71, 3: 4.69, 4: 4.68, 5: 4.66,
                        6: 5.64, 7: 5.61, 8: 5.58, 9: 5.56, 10: 5.53, 11: 5.51,
                        12: 5.48, 13: 5.46, 15: 5.41, 18: 5.34, 24: 5.20, 36: 4.94
                    }
                }
            ];

            const listingDataPeriodic = {
                monthly: { 3: 4.73, 4: 4.72, 5: 4.71, 6: 5.73, 7: 5.72, 8: 5.70, 9: 5.69, 10: 5.68, 11: 5.66, 12: 5.65, 13: 5.64, 15: 5.61, 18: 5.57, 24: 5.50, 36: 5.36 },
                quarterly: { 6: 5.76, 9: 5.72, 12: 5.68, 15: 5.64, 18: 5.60, 24: 5.53, 36: 5.38 },
                '6months': { 12: 5.72, 18: 5.64, 24: 5.56, 36: 5.42 },
                yearly: { 24: 5.64, 36: 5.49 }
            };

            // ==========================================
            // 2. DATA: TH·∫®M QUY·ªÄN
            // ==========================================
            const authorityRoles = {
                'Level1': 'GƒêKV/ GƒêCN/ GƒêCN core/ Gƒê TTKD Private',
                'Level2': 'GƒêV/ Gƒê TTKD Private',
                'Level3': 'GƒêM (Gi√°m ƒë·ªëc Mi·ªÅn)',
            };

            const authorityData = {
                counter: [
                    { min: 100000000, max: 500000000, label: '100tr - < 500tr', auth: 'Level1', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.00, t7: 7.10, t8_13: 6.70, t15_plus: 6.70 } },
                    { min: 500000000, max: 1000000000, label: '500tr - < 1 t·ª∑', auth: 'Level1', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.10, t7: 7.20, t8_13: 6.80, t15_plus: 6.80 } },
                    { min: 1000000000, max: 3000000000, label: '>= 1 t·ª∑', auth: 'Level1', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.10, t7: 7.20, t8_13: 6.80, t15_plus: 6.80 } },
                    { min: 3000000000, max: 10000000000, label: '>= 3 t·ª∑', auth: 'Level2', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.20, t7: 7.30, t8_13: 6.90, t15_plus: 6.90 } },
                    { min: 10000000000, max: 50000000000, label: '>= 10 t·ª∑', auth: 'Level3', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.30, t7: 7.40, t8_13: 7.05, t15_plus: 7.05 } },
                    { min: 50000000000, max: Infinity, label: '>= 50 t·ª∑', auth: 'Level3', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.40, t7: 7.50, t8_13: 7.10, t15_plus: 7.10 } },
                ],
                online: [
                    { min: 100000000, max: 300000000, label: '100tr - < 300tr', auth: 'Level1', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.10, t7: 7.20, t8_13: 6.80, t15_plus: 6.80 } },
                    { min: 300000000, max: 1000000000, label: '300tr - < 1 t·ª∑', auth: 'Level1', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.20, t7: 7.30, t8_13: 6.90, t15_plus: 6.90 } },
                    { min: 1000000000, max: 3000000000, label: '>= 1 t·ª∑', auth: 'Level1', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.20, t7: 7.30, t8_13: 6.90, t15_plus: 6.90 } },
                    { min: 3000000000, max: 10000000000, label: '>= 3 t·ª∑', auth: 'Level2', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.30, t7: 7.40, t8_13: 7.00, t15_plus: 7.00 } },
                    { min: 10000000000, max: 50000000000, label: '>= 10 t·ª∑', auth: 'Level3', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.40, t7: 7.50, t8_13: 7.15, t15_plus: 7.15 } },
                    { min: 50000000000, max: Infinity, label: '>= 50 t·ª∑', auth: 'Level3', rates: { t1_2: 4.75, t3_5: 4.75, t6: 7.50, t7: 7.60, t8_13: 7.20, t15_plus: 7.20 } },
                ]
            };

            // ==========================================
            // 3. DATA: LSMV (FTP)
            // ==========================================
            const lsmvData = [
                { label: 'TTTH(*)', month: 0, maturity: 2.44, monthly: 2.44, quarterly: 2.44, semiAnnual: 2.44, annual: 2.44, prepaid: 2.44 },
                { label: '1 Tu·∫ßn', month: 0.25, maturity: 2.44, prepaid: 2.44 },
                { label: '2 Tu·∫ßn', month: 0.5, maturity: 2.44, prepaid: 2.44 },
                { label: '3 Tu·∫ßn', month: 0.75, maturity: 2.44, prepaid: 2.44 },
                { label: '1 Th√°ng', month: 1, maturity: 5.40, monthly: 5.40, prepaid: 5.38 },
                { label: '2 Th√°ng', month: 2, maturity: 5.40, monthly: 5.39, prepaid: 5.35 },
                { label: '3 Th√°ng', month: 3, maturity: 5.40, monthly: 5.38, prepaid: 5.33 },
                { label: '4 Th√°ng', month: 4, maturity: 5.65, monthly: 5.61, prepaid: 5.55 },
                { label: '5 Th√°ng', month: 5, maturity: 5.90, monthly: 5.84, prepaid: 5.76 },
                { label: '6 Th√°ng', month: 6, maturity: 8.05, monthly: 7.92, quarterly: 7.97, prepaid: 7.74 },
                { label: '7 Th√°ng', month: 7, maturity: 8.15, monthly: 7.99, prepaid: 7.78 },
                { label: '8 Th√°ng', month: 8, maturity: 7.85, monthly: 7.68, prepaid: 7.46 },
                { label: '9 Th√°ng', month: 9, maturity: 7.85, monthly: 7.65, quarterly: 7.70, prepaid: 7.42 },
                { label: '10 Th√°ng', month: 10, maturity: 7.85, monthly: 7.63, prepaid: 7.37 },
                { label: '11 Th√°ng', month: 11, maturity: 7.85, monthly: 7.61, prepaid: 7.32 },
                { label: '12 Th√°ng', month: 12, maturity: 7.85, monthly: 7.58, quarterly: 7.63, semiAnnual: 7.70, prepaid: 7.28 },
                { label: '13 Th√°ng', month: 13, maturity: 7.85, monthly: 7.56, prepaid: 7.24 },
                { label: '15 Th√°ng', month: 15, maturity: 7.85, monthly: 7.51, quarterly: 7.56, prepaid: 7.15 },
                { label: '18 Th√°ng', month: 18, maturity: 7.85, monthly: 7.45, quarterly: 7.49, semiAnnual: 7.56, prepaid: 7.02 },
                { label: '24 Th√°ng', month: 24, maturity: 7.85, monthly: 7.32, quarterly: 7.36, semiAnnual: 7.43, annual: 7.57, prepaid: 6.79 },
                { label: '36 Th√°ng', month: 36, maturity: 7.85, monthly: 7.07, quarterly: 7.11, semiAnnual: 7.18, annual: 7.31, prepaid: 6.36 },
                { label: '48 Th√°ng', month: 48, maturity: 7.85, monthly: 6.85, quarterly: 6.89, semiAnnual: 6.95, annual: 7.07, prepaid: 5.98 },
                { label: '60 Th√°ng', month: 60, maturity: 7.85, monthly: 6.64, quarterly: 6.68, semiAnnual: 6.73, annual: 6.85, prepaid: 5.64 }
            ];

            const calculateEquivalentRate = (baseRateEndOfTerm, months, method) => {
                if (!baseRateEndOfTerm || !months) return 0;
                const R_ck = baseRateEndOfTerm / 100;
                const n = months;
                let R_kq = 0;

                switch (method) {
                case 'maturity': return baseRateEndOfTerm;
                case 'monthly': R_kq = (Math.pow(1 + (R_ck * n) / 12, 1 / n) - 1) * 12; break;
                case 'quarterly': R_kq = (Math.pow(1 + (R_ck * n) / 12, 3 / n) - 1) * 4; break;
                case '6months': R_kq = (Math.pow(1 + (R_ck * n) / 12, 6 / n) - 1) * 2; break;
                case 'yearly': R_kq = (Math.pow(1 + (R_ck * n) / 12, 12 / n) - 1) * 1; break;
                case 'prepaid': R_kq = R_ck / (1 + (R_ck * n) / 12); break;
                default: return baseRateEndOfTerm;
                }
                return R_kq * 100;
            };

            const proposalData = useMemo(() => {
                const amount = Number(authAmount) || 0;
                const month = Number(authMonth) || 0;

                let listedRate = 0;
                let rangeLabel = '';

                if (paymentMethod === 'maturity') {
                    const currentListingTable = depositType === 'online' ? listingDataMaturity.online : listingDataMaturity.counter;
                    const listRow = currentListingTable.find(r => amount >= r.min && amount < r.max) || currentListingTable[currentListingTable.length - 1];
                    rangeLabel = listRow.range;
                    
                    if (month < 1) listedRate = listRow.rates.w1_3;
                    else if (month <= 15) listedRate = listRow.rates[`m${month}`] || listRow.rates[`m${month-1}`] || 5.8;
                    else if (month === 18) listedRate = listRow.rates.m18;
                    else if (month === 24) listedRate = listRow.rates.m24;
                    else if (month === 36) listedRate = listRow.rates.m36;
                    else listedRate = listRow.rates.m24 || 5.8; 

                } else if (paymentMethod === 'prepaid') {
                    const listRow = listingDataPrepaid.find(r => amount >= r.min && amount < r.max) || listingDataPrepaid[listingDataPrepaid.length - 1];
                    listedRate = listRow.rates[month] || 0;
                    rangeLabel = listRow.range;
                } else {
                    const table = listingDataPeriodic[paymentMethod];
                    listedRate = table ? (table[month] || 0) : 0;
                    rangeLabel = 'Chung (Periodic)';
                }

                const currentAuthorityTable = depositType === 'online' ? authorityData.online : authorityData.counter;
                const authRow = currentAuthorityTable.find(r => amount >= r.min && amount < r.max);
                let authorityRateBase = 0;
                let authRole = "Ch∆∞a h·ªó tr·ª£";
                let termKey = "";

                if (authRow) {
                    authRole = authorityRoles[authRow.auth];
                    if (month >= 1 && month <= 2) { authorityRateBase = authRow.rates.t1_2; termKey = "1-2M"; }
                    else if (month >= 3 && month <= 5) { authorityRateBase = authRow.rates.t3_5; termKey = "3-5M"; }
                    else if (month === 6) { authorityRateBase = authRow.rates.t6; termKey = "6M"; }
                    else if (month === 7) { authorityRateBase = authRow.rates.t7; termKey = "7M"; }
                    else if (month >= 8 && month <= 13) { authorityRateBase = authRow.rates.t8_13; termKey = "8-13M"; }
                    else if (month >= 15) { authorityRateBase = authRow.rates.t15_plus; termKey = ">= 15M"; }
                }

                const authorityRate = calculateEquivalentRate(authorityRateBase, month, paymentMethod);

                const lsmvRow = lsmvData.find(r => r.month === month);
                let lsmvRate = 0;
                if (lsmvRow) {
                    switch (paymentMethod) {
                        case 'monthly': lsmvRate = lsmvRow.monthly || 0; break;
                        case 'quarterly': lsmvRate = lsmvRow.quarterly || 0; break;
                        case '6months': lsmvRate = lsmvRow.semiAnnual || 0; break;
                        case 'yearly': lsmvRate = lsmvRow.annual || 0; break;
                        case 'prepaid': lsmvRate = lsmvRow.prepaid || 0; break;
                        default: lsmvRate = lsmvRow.maturity || 0;
                    }
                } else {
                    lsmvRate = month >= 6 ? 8.05 : 5.40;
                }

                const spread = (authorityRate - listedRate).toFixed(2);
                const nim = (lsmvRate - authorityRate).toFixed(2);
                const casaCommitment = amount * 0.005;

                const interestListed = Math.round(amount * (listedRate / 100) * (month / 12));
                const interestAuthority = Math.round(amount * (authorityRate / 100) * (month / 12));
                const interestDiff = interestAuthority - interestListed;

                return { 
                    listedRate, authorityRate, authRole, lsmvRate, 
                    spread, nim, rangeLabel, authLabel: authRow ? authRow.label : '', casaCommitment,
                    interestListed, interestAuthority, interestDiff 
                };
            }, [authAmount, authMonth, depositType, paymentMethod]);

            // Listing Table Component
            const ListingTableRender = ({ data, title, type }) => (
                <div className="bg-white rounded-xl shadow border border-slate-200 overflow-hidden mb-8">
                    <div className={`p-3 font-bold flex justify-between items-center ${type === 'online' ? 'bg-blue-600 text-white' : 'bg-green-600 text-white'}`}>
                        <span className="flex items-center gap-2">
                            {type === 'online' ? 'üíª' : 'üè™'} {title}
                        </span>
                        <span className="text-xs bg-white/20 px-2 py-1 rounded">Hi·ªáu l·ª±c t·ª´ 09/12/2025</span>
                    </div>
                    <div className="overflow-x-auto">
                        <table className="w-full text-sm text-left">
                        <thead className={`${type === 'online' ? 'bg-blue-500' : 'bg-green-500'} text-white text-xs uppercase`}>
                            <tr>
                                <th className={`p-3 whitespace-nowrap sticky left-0 z-10 ${type === 'online' ? 'bg-blue-500' : 'bg-green-500'}`}>M·ª©c ti·ªÅn</th>
                                <th className="p-3 text-center">1-3W</th><th className="p-3 text-center">1T</th><th className="p-3 text-center">2T</th><th className="p-3 text-center">3-5T</th>
                                <th className="p-3 text-center">6-11T</th><th className="p-3 text-center">12-13T</th><th className="p-3 text-center">15-18T</th><th className="p-3 text-center">24-36T</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-slate-100">
                            {data.map((r,i) => {
                                const isSelected = Number(authAmount) >= r.min && Number(authAmount) < r.max;
                                return (
                                    <tr key={i} className={`hover:bg-slate-50 ${isSelected ? 'bg-yellow-50' : ''}`}>
                                        <td className={`p-3 border-r sticky left-0 ${isSelected ? 'bg-yellow-50 font-bold text-green-800' : 'bg-white'}`}>{r.range}</td>
                                        <td className="p-3 text-center border-r">{r.rates.w1_3 ? r.rates.w1_3.toFixed(2) : '-'}</td>
                                        <td className="p-3 text-center border-r">{r.rates.m1 ? r.rates.m1.toFixed(2) : '-'}</td>
                                        <td className="p-3 text-center border-r">{r.rates.m2 ? r.rates.m2.toFixed(2) : '-'}</td>
                                        <td className="p-3 text-center border-r">{r.rates.m3_5 ? r.rates.m3_5.toFixed(2) : '-'}</td>
                                        <td className="p-3 text-center border-r font-bold">{r.rates.m6 ? r.rates.m6.toFixed(2) : '-'}</td>
                                        <td className="p-3 text-center border-r font-bold">{r.rates.m12 ? r.rates.m12.toFixed(2) : '-'}</td>
                                        <td className="p-3 text-center border-r">{r.rates.m15 ? r.rates.m15.toFixed(2) : '-'}</td>
                                        <td className="p-3 text-center">{r.rates.m36 ? r.rates.m36.toFixed(2) : '-'}</td>
                                    </tr>
                                )
                            })}
                        </tbody>
                        </table>
                    </div>
                </div>
            );

            // Authority Table Component
            const RenderTable = ({ data, title, type }) => (
                <div className="bg-white rounded-xl shadow-lg border border-emerald-200 overflow-hidden mb-8">
                <div className={`p-4 border-b border-emerald-100 flex justify-between items-center ${type === 'online' ? 'bg-blue-50' : 'bg-green-50'}`}>
                    <h3 className={`font-bold flex items-center gap-2 ${type === 'online' ? 'text-blue-800' : 'text-green-800'}`}>
                    {type === 'online' ? 'üíª' : 'üè™'} {title}
                    </h3>
                    <span className="text-xs font-medium px-2 py-1 rounded border bg-white/50">Hi·ªáu l·ª±c 09/12/2025</span>
                </div>
                <div className="overflow-x-auto">
                    <table className="w-full text-sm text-left border-collapse">
                    <thead className={`text-xs uppercase ${type === 'online' ? 'bg-blue-100 text-blue-900' : 'bg-green-100 text-green-900'}`}>
                        <tr>
                        <th className="px-4 py-3 border-r border-white/50 font-bold min-w-[140px] sticky left-0 z-10">S·ªë ti·ªÅn</th>
                        <th className="px-2 py-3 border-r border-white/50 text-center font-bold">1-2M</th>
                        <th className="px-2 py-3 border-r border-white/50 text-center font-bold">3-5M</th>
                        <th className="px-2 py-3 border-r border-white/50 text-center font-bold">6M</th>
                        <th className="px-2 py-3 border-r border-white/50 text-center font-bold">7M</th>
                        <th className="px-2 py-3 border-r border-white/50 text-center font-bold">8-13M</th>
                        <th className="px-2 py-3 text-center font-bold">&ge; 15M</th>
                        </tr>
                    </thead>
                    <tbody className="divide-y divide-slate-100">
                        {data.map((row, index) => {
                        const isSelected = Number(authAmount) >= row.min && Number(authAmount) < row.max;
                        return (
                        <tr key={index} className={`hover:bg-slate-50 transition-colors ${isSelected ? 'bg-yellow-50 relative z-0' : ''}`}>
                            <td className={`px-4 py-3 font-bold text-slate-800 border-r border-slate-100 sticky left-0 
                                ${isSelected ? 'bg-yellow-50 text-emerald-700 border-r-emerald-200' : 'bg-white'}`}>
                            {row.label}
                            </td>
                            <td className="px-2 py-3 text-center font-medium text-emerald-600 border-r border-slate-100">{row.rates.t1_2.toFixed(2)}</td>
                            <td className="px-2 py-3 text-center font-medium text-emerald-600 border-r border-slate-100">{row.rates.t3_5.toFixed(2)}</td>
                            <td className="px-2 py-3 text-center font-medium text-emerald-600 border-r border-slate-100">{row.rates.t6.toFixed(2)}</td>
                            <td className="px-2 py-3 text-center font-medium text-emerald-600 border-r border-slate-100">{row.rates.t7.toFixed(2)}</td>
                            <td className="px-2 py-3 text-center font-medium text-emerald-600 border-r border-slate-100">{row.rates.t8_13.toFixed(2)}</td>
                            <td className="px-2 py-3 text-center font-medium text-emerald-600">{row.rates.t15_plus.toFixed(2)}</td>
                        </tr>
                        )})}
                    </tbody>
                    </table>
                </div>
                </div>
            );

            return (
                <div className="flex flex-col h-full bg-slate-50 text-slate-900 font-sans min-h-screen">
                <header className="bg-gradient-to-r from-blue-900 to-indigo-800 text-white p-6 shadow-md">
                    <div className="max-w-6xl mx-auto">
                    <h1 className="text-2xl font-bold flex items-center gap-2">üíº C√¥ng c·ª• Tr√¨nh L√£i Su·∫•t Ti·∫øt Ki·ªám</h1>
                    <p className="text-blue-100 mt-2 text-sm opacity-90">VPBank Nha Trang</p>
                    </div>
                </header>

                <main className="flex-1 max-w-6xl w-full mx-auto p-4 md:p-6 space-y-6">
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-2 bg-white p-1.5 rounded-xl shadow-sm border border-slate-200">
                    <button onClick={() => setActiveTab('proposal')} className={`py-3 px-2 rounded-lg text-sm font-bold flex justify-center gap-2 ${activeTab === 'proposal' ? 'bg-indigo-100 text-indigo-800 shadow-sm' : 'text-slate-500 hover:bg-slate-50'}`}>üìù Tr√¨nh Th·∫©m Quy·ªÅn</button>
                    <button onClick={() => setActiveTab('authority')} className={`py-3 px-2 rounded-lg text-sm font-bold flex justify-center gap-2 ${activeTab === 'authority' ? 'bg-emerald-100 text-emerald-800 shadow-sm' : 'text-slate-500 hover:bg-slate-50'}`}>üõ°Ô∏è B·∫£ng LS Th·∫©m Quy·ªÅn</button>
                    <button onClick={() => setActiveTab('listing')} className={`py-3 px-2 rounded-lg text-sm font-bold flex justify-center gap-2 ${activeTab === 'listing' ? 'bg-green-100 text-green-800 shadow-sm' : 'text-slate-500 hover:bg-slate-50'}`}>üìú B·∫£ng LS Ni√™m Y·∫øt</button>
                    <button onClick={() => setActiveTab('lsmv_table')} className={`py-3 px-2 rounded-lg text-sm font-bold flex justify-center gap-2 ${activeTab === 'lsmv_table' ? 'bg-blue-100 text-blue-800 shadow-sm' : 'text-slate-500 hover:bg-slate-50'}`}>üìä B·∫£ng LSMV</button>
                    </div>

                    {activeTab === 'proposal' && (
                    <div className="space-y-6 animate-in fade-in duration-300">
                        <div className="bg-white p-6 rounded-xl shadow-lg border border-indigo-100 grid grid-cols-1 md:grid-cols-2 gap-6 relative overflow-hidden">
                        <div className="absolute top-0 right-0 p-4 opacity-5 text-9xl">üìù</div>
                        <div className="relative z-10 space-y-4">
                            <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">S·ªë ti·ªÅn huy ƒë·ªông (VND)</label>
                                <div className="relative">
                                <span className="absolute left-3 top-3 text-slate-400">üíµ</span>
                                <input type="text" value={formatNumberWithDots(authAmount)} 
                                    onChange={(e) => {
                                        const val = e.target.value.replace(/\./g, '');
                                        if (!isNaN(val)) setAuthAmount(val === '' ? '' : Number(val));
                                    }}
                                    className="w-full pl-10 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 font-bold text-lg text-slate-800" 
                                />
                                </div>
                                <div className="flex justify-between items-center mt-1">
                                    <p className="text-xs text-slate-500 italic">{formatNumberWithDots(Number(authAmount) || 0)} ‚Ç´</p>
                                    <span className="text-xs font-bold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded border border-indigo-100">Khung: {proposalData.authLabel}</span>
                                </div>
                            </div>
                            <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">H√¨nh th·ª©c g·ª≠i</label>
                                <div className="flex bg-slate-100 p-1 rounded-lg border border-slate-200">
                                    <button onClick={() => setDepositType('online')} className={`flex-1 py-2 px-4 rounded-md text-sm font-bold flex items-center justify-center gap-2 ${depositType === 'online' ? 'bg-white text-blue-600 shadow-sm' : 'text-slate-500'}`}>üíª Online</button>
                                    <button onClick={() => setDepositType('counter')} className={`flex-1 py-2 px-4 rounded-md text-sm font-bold flex items-center justify-center gap-2 ${depositType === 'counter' ? 'bg-white text-indigo-700 shadow-sm' : 'text-slate-500'}`}>üè™ T·∫°i Qu·∫ßy</button>
                                </div>
                            </div>
                        </div>
                        <div className="relative z-10 space-y-4">
                            <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">K·ª≥ h·∫°n g·ª≠i (Th√°ng)</label>
                                <div className="relative">
                                <span className="absolute left-3 top-3 text-slate-400">üìÖ</span>
                                <input type="number" value={authMonth} 
                                    onChange={(e) => setAuthMonth(e.target.value === '' ? '' : Number(e.target.value))}
                                    className="w-full pl-10 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 font-bold text-lg text-slate-800" placeholder="VD: 6" 
                                />
                                </div>
                                <div className="flex gap-2 mt-2 flex-wrap">
                                {[1, 3, 6, 7, 12, 13].map(m => (
                                    <button key={m} onClick={() => setAuthMonth(m)} className={`text-xs px-3 py-1 rounded border font-medium ${Number(authMonth) === m ? 'bg-indigo-600 text-white' : 'bg-slate-50'}`}>{m}T</button>
                                ))}
                                </div>
                            </div>
                            <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">üïí Ph∆∞∆°ng th·ª©c tr·∫£ l√£i</label>
                                <select value={paymentMethod} onChange={(e) => setPaymentMethod(e.target.value)} className="w-full p-2.5 bg-white border border-slate-300 rounded-lg text-sm font-medium focus:ring-2 focus:ring-indigo-500">
                                    <option value="maturity">Cu·ªëi k·ª≥ (M·∫∑c ƒë·ªãnh)</option>
                                    {(Number(authMonth) || 0) >= 3 && <option value="monthly">H√†ng th√°ng</option>}
                                    {(Number(authMonth) || 0) >= 6 && <option value="quarterly">H√†ng qu√Ω</option>}
                                    {(Number(authMonth) || 0) >= 6 && <option value="6months">6 th√°ng/l·∫ßn</option>}
                                    {(Number(authMonth) || 0) >= 12 && <option value="yearly">H√†ng nƒÉm</option>}
                                    <option value="prepaid">Tr·∫£ l√£i tr∆∞·ªõc</option>
                                </select>
                            </div>
                        </div>
                        </div>

                        {/* Result Cards */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div className="lg:col-span-2 bg-white rounded-xl shadow-md border border-slate-200 overflow-hidden">
                                <div className="p-4 bg-slate-50 border-b border-slate-100 font-bold text-slate-700 flex items-center gap-2">üìã Chi Ti·∫øt L√£i Su·∫•t ({depositType === 'online' ? 'Online' : 'T·∫°i Qu·∫ßy'})</div>
                                <div className="p-6 grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                                    <div className="p-4 rounded-lg bg-green-50 border border-green-100 flex flex-col items-center justify-center">
                                        <span className="text-xs uppercase font-bold text-green-700 mb-1">Ni√™m Y·∫øt</span>
                                        <span className="text-2xl font-bold text-slate-800">{proposalData.listedRate ? proposalData.listedRate.toFixed(2) : '-'}%</span>
                                        {paymentMethod !== 'maturity' && <span className="text-[10px] text-slate-500">(Theo b·∫£ng)</span>}
                                    </div>
                                    <div className="hidden md:flex flex-col items-center justify-center">‚û°Ô∏è</div>
                                    <div className="p-4 rounded-lg bg-indigo-50 border border-indigo-100 flex flex-col items-center justify-center relative">
                                        <span className="absolute -top-3 bg-indigo-600 text-white text-[10px] uppercase font-bold px-2 py-0.5 rounded-full">Tr·∫ßn Ph√™ Duy·ªát</span>
                                        <span className="text-xs uppercase font-bold text-indigo-700 mb-1">Th·∫©m Quy·ªÅn</span>
                                        <span className="text-3xl font-extrabold text-indigo-700">{proposalData.authorityRate ? proposalData.authorityRate.toFixed(2) : '-'}%</span>
                                        {paymentMethod !== 'maturity' && <span className="text-[10px] text-indigo-500">(Quy ƒë·ªïi t·ª´ {proposalData.termKey})</span>}
                                        <span className="text-xs text-indigo-400 mt-1">{proposalData.authRole}</span>
                                    </div>
                                </div>
                                <div className="mx-6 mb-6 p-3 bg-blue-50 rounded-lg border border-blue-100 flex justify-between items-center">
                                    <div className="flex items-center gap-2">üõ°Ô∏è <span className="text-sm font-medium text-blue-800">LSMV (FTP)</span></div>
                                    <span className="text-xl font-bold text-blue-700">{proposalData.lsmvRate.toFixed(2)}%</span>
                                    <span className="text-[10px] text-blue-500 bg-blue-50 px-2 py-0.5 rounded border border-blue-100">{paymentMethod === 'maturity' ? 'Cu·ªëi k·ª≥' : paymentMethod === 'prepaid' ? 'ƒê·∫ßu k·ª≥' : 'ƒê·ªãnh k·ª≥'}</span>
                                </div>
                            </div>

                            <div className="bg-white rounded-xl shadow-md border border-slate-200 flex flex-col">
                                <div className="p-4 bg-slate-50 border-b border-slate-100 font-bold text-slate-700">üìà Hi·ªáu Qu·∫£ Deal</div>
                                <div className="flex-1 p-6 flex flex-col justify-center space-y-6">
                                    <div>
                                        <div className="flex justify-between items-end mb-1"><span className="text-sm font-bold text-slate-700">‚ÜóÔ∏è ∆Øu ƒë√£i l√£i su·∫•t</span></div>
                                        <div className="p-4 bg-orange-50 rounded-lg border border-orange-200 text-center"><span className="text-4xl font-extrabold text-orange-600">+{proposalData.spread}%</span></div>
                                        <div className="mt-2 pt-2 border-t border-orange-200 text-xs text-orange-800">T∆∞∆°ng ·ª©ng v·ªõi l√£i su·∫•t in tr√™n s·ªï: <span className="font-bold">{proposalData.authorityRate ? proposalData.authorityRate.toFixed(2) : '-'}%</span></div>
                                    </div>
                                    <div className="w-full h-px bg-slate-100"></div>
                                    <div>
                                        <div className="flex justify-between items-end mb-1"><span className="text-sm font-bold text-slate-700">üìä NIM Huy ƒë·ªông</span></div>
                                        <div className={`p-4 rounded-lg border text-center ${getNimColor(Number(proposalData.nim))}`}><span className="text-4xl font-extrabold">{Number(proposalData.nim) < 0 ? '‚ö†Ô∏è' : '‚úÖ'} {proposalData.nim}%</span></div>
                                        <div className="mt-2 pt-2 border-t border-black/10 text-xs opacity-90">M·ª©c LSMV √°p d·ª•ng: <span className="font-bold">{proposalData.lsmvRate.toFixed(2)}%</span></div>
                                    </div>
                                    <div className="w-full h-px bg-slate-100"></div>
                                    <div>
                                        <div className="flex justify-between items-end mb-1"><span className="text-sm font-bold text-indigo-800">üëõ Cam k·∫øt Casa</span></div>
                                        <div className="p-4 rounded-lg border border-indigo-200 bg-indigo-50 text-center"><div className="text-xl font-bold text-indigo-700">{formatNumberWithDots(proposalData.casaCommitment)} ‚Ç´</div></div>
                                        <div className="mt-2 pt-2 border-t border-indigo-200 text-xs text-indigo-600 italic">(0.5% tr√™n t·ªïng ti·ªÅn g·ª≠i)</div>
                                    </div>
                                    <div className="mt-4 pt-4 border-t border-slate-100 space-y-3 text-sm">
                                        <div className="flex justify-between"><span>L√£i Ni√™m y·∫øt:</span><span className="font-medium">{formatNumberWithDots(proposalData.interestListed)} ‚Ç´</span></div>
                                        <div className="flex justify-between"><span className="text-indigo-600 font-medium">L√£i Th·∫©m quy·ªÅn:</span><span className="font-bold text-indigo-700">{formatNumberWithDots(proposalData.interestAuthority)} ‚Ç´</span></div>
                                        <div className="p-3 bg-green-50 rounded-lg border border-green-200 flex justify-between"><span className="font-bold text-green-800">ü™ô Kh√°ch l·ª£i th√™m:</span><span className="font-extrabold text-green-700">+{formatNumberWithDots(proposalData.interestDiff)} ‚Ç´</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    )}

                    {activeTab === 'authority' && (
                        <div className="space-y-6 animate-in fade-in">
                            <div className="p-4 bg-blue-50 rounded-lg border border-blue-200 text-blue-800 text-sm mb-4">‚ÑπÔ∏è B·∫£ng th·∫©m quy·ªÅn hi·ªán t·∫°i ch·ªâ √°p d·ª•ng cho l√£i su·∫•t <strong>Cu·ªëi K·ª≥</strong>. C√°c ph∆∞∆°ng th·ª©c tr·∫£ l√£i kh√°c ƒë∆∞·ª£c quy ƒë·ªïi t∆∞∆°ng ƒë∆∞∆°ng.</div>
                            <RenderTable data={authorityData.counter} title="B·∫£ng L√£i Su·∫•t T·∫°i Qu·∫ßy" type="counter" />
                            <RenderTable data={authorityData.online} title="B·∫£ng L√£i Su·∫•t Online" type="online" />
                        </div>
                    )}

                    {activeTab === 'listing' && (
                        <div className="space-y-8 animate-in fade-in">
                            <ListingTableRender data={listingDataMaturity.counter} title="Ni√™m Y·∫øt T·∫°i Qu·∫ßy (Cu·ªëi K·ª≥)" type="counter" />
                            <ListingTableRender data={listingDataMaturity.online} title="Ni√™m Y·∫øt Online (Cu·ªëi K·ª≥)" type="online" />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="bg-white rounded-xl shadow border border-slate-200 overflow-hidden">
                                    <div className="p-3 bg-green-600 text-white font-bold flex items-center gap-2">‚ÜóÔ∏è L√£i Su·∫•t Tr·∫£ Tr∆∞·ªõc (Ph√¢n T·∫ßng)</div>
                                    <div className="overflow-x-auto h-[300px]">
                                        <table className="w-full text-sm">
                                            <thead className="bg-green-500 text-white text-xs sticky top-0">
                                                <tr><th className="p-3">K·ª≥ h·∫°n</th><th className="p-3 text-right">&lt; 5 T·ª∑</th><th className="p-3 text-right">‚â• 5 T·ª∑</th></tr>
                                            </thead>
                                            <tbody className="divide-y">
                                                {Object.entries(listingDataPrepaid[0].rates).map(([k,v]) => (
                                                    <tr key={k}><td className="p-3 font-medium">{k} Th√°ng</td><td className="p-3 text-right font-bold text-slate-600">{v}</td><td className="p-3 text-right font-bold text-green-700">{listingDataPrepaid[1].rates[k]}</td></tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div className="bg-white rounded-xl shadow border border-slate-200 overflow-hidden">
                                    <div className="p-3 bg-orange-500 text-white font-bold flex items-center gap-2">üïí L√£i Su·∫•t H√†ng Th√°ng</div>
                                    <div className="overflow-x-auto h-[300px]">
                                        <table className="w-full text-sm">
                                            <thead className="bg-orange-400 text-white text-xs sticky top-0"><tr><th className="p-3">K·ª≥ h·∫°n</th><th className="p-3 text-right">L√£i su·∫•t (%)</th></tr></thead>
                                            <tbody className="divide-y">
                                                {Object.entries(listingDataPeriodic.monthly).map(([k,v]) => (
                                                    <tr key={k}><td className="p-3 font-medium">{k} Th√°ng</td><td className="p-3 text-right font-bold">{v}</td></tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {activeTab === 'lsmv_table' && (
                        <div className="bg-white rounded-xl shadow overflow-hidden animate-in fade-in">
                            <div className="p-4 bg-blue-50 border-b border-blue-100 font-bold text-blue-800">üìä B·∫£ng L√£i Su·∫•t Mua B√°n V·ªën (FTP) Chi Ti·∫øt</div>
                            <div className="overflow-x-auto">
                                <table className="w-full text-sm text-left">
                                    <thead className="bg-slate-100 text-slate-600 text-xs uppercase">
                                        <tr>
                                            <th className="p-3 border-r">K·ª≥ h·∫°n</th>
                                            <th className="p-3 border-r text-center">Cu·ªëi k·ª≥</th>
                                            <th className="p-3 border-r text-center">Th√°ng</th>
                                            <th className="p-3 border-r text-center">Qu√Ω</th>
                                            <th className="p-3 border-r text-center">6M</th>
                                            <th className="p-3 border-r text-center">NƒÉm</th>
                                            <th className="p-3 text-center bg-blue-50 text-blue-800">ƒê·∫ßu k·ª≥</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-100">
                                        {lsmvData.map((r,i) => (
                                            <tr key={i} className="hover:bg-blue-50">
                                                <td className="p-3 font-bold border-r">{r.label}</td>
                                                <td className="p-3 text-center border-r font-bold text-indigo-700">{r.maturity?.toFixed(2)}%</td>
                                                <td className="p-3 text-center border-r">{r.monthly ? r.monthly.toFixed(2)+'%' : '-'}</td>
                                                <td className="p-3 text-center border-r">{r.quarterly ? r.quarterly.toFixed(2)+'%' : '-'}</td>
                                                <td className="p-3 text-center border-r">{r.semiAnnual ? r.semiAnnual.toFixed(2)+'%' : '-'}</td>
                                                <td className="p-3 text-center border-r">{r.annual ? r.annual.toFixed(2)+'%' : '-'}</td>
                                                <td className="p-3 text-center font-bold text-blue-700 bg-blue-50/30">{r.prepaid ? r.prepaid.toFixed(2)+'%' : '-'}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                            <div className="bg-blue-50 p-5 border-t border-blue-200">
                                <h4 className="font-bold text-blue-900 mb-3">üìñ Gi·∫£i th√≠ch c√°c lo·∫°i L√£i su·∫•t Mua b√°n v·ªën (FTP)</h4>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-blue-800">
                                    <div className="bg-white p-3 rounded shadow-sm"><span className="font-bold text-indigo-600 block mb-1">1. LSMV Cu·ªëi K·ª≥</span>√Åp d·ª•ng khi huy ƒë·ªông v·ªën tr·∫£ l√£i v√†o cu·ªëi k·ª≥ h·∫°n.</div>
                                    <div className="bg-white p-3 rounded shadow-sm"><span className="font-bold text-orange-600 block mb-1">2. LSMV ƒê·ªãnh K·ª≥</span>√Åp d·ª•ng khi kh√°ch h√†ng nh·∫≠n l√£i h√†ng th√°ng, h√†ng qu√Ω...</div>
                                    <div className="bg-white p-3 rounded shadow-sm"><span className="font-bold text-blue-600 block mb-1">3. LSMV ƒê·∫ßu K·ª≥</span>√Åp d·ª•ng khi tr·∫£ l√£i ngay l√∫c g·ª≠i ti·ªÅn (Prepaid).</div>
                                </div>
                            </div>
                        </div>
                    )}
                </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<InterestApprovalTool />);
    </script>
</body>
</html>



